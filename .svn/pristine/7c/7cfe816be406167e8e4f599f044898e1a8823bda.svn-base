<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec"%>
<sec:authentication property="principal.employee" var="empVO" />
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="/resources/js/jquery-3.6.0.js"></script>
<title>Insert title here</title>
<style>
.card {
	width: 70vw;
	height:79vh;
	margin: 27px 0px 0px 265px;
}
#orderHeader {
	display:flex;
	width:81.6vw;
	margin:0px 0px 25px 0px;
}
.card-header {
	margin: 17px 0px 0px 5px;
	font-weight:bolder;
}
#orderBtn {
    width: 4vw;
    height: 4vh;
    margin-top: 35px;
}
.table-hover {
    margin-left: 18px;
    width: 68vw;
}
.text-nowrap {
	height: 57vh;
}
#rejectBtn {
	width: 4vw;
    height: 4vh;
    padding: 3px 0px 0px 0px!important;
    margin: 14px 0px -2px 1245px;
}
a, a:active {
	color: inherit;
	text-decoration: none;
}
#myTable {
	overflow: auto;
}
</style>
</head>
<body>
	<div class="card">
		<div id="wrapper">
			<div id="orderHeader">
				<div>
					<div style="display:flex;">
						<h4 class="card-header">ì•½í’ˆ ì‹ ì²­ ì¡°íšŒ</h4>
						<button class="btn btn-primary" type="button" id="orderBtn">ë°œì£¼</button>
					</div>
					<p style="margin:8px 0px -10px 25px;"></p>
				</div>
			</div><!-- notice header ë -->
			
			<!-- í…Œì´ë¸” ì²˜ë¦¬ -->
			<div class="table-responsive text-nowrap">
			<div id="myTable">
			</div>
			</div><!-- table div ë -->
			
			<button type="button" class="btn btn-secondary" id="rejectBtn">ë°˜ë ¤</button>
			
		</div><!-- wrapper ë -->
	</div><!-- card ë -->
</body>
<script>
$(function(){
	getMediItemList();
});

// ì•½í’ˆ ì‹ ì²­ ì¡°íšŒ ë¦¬ìŠ¤íŠ¸ ë¿Œë¦¬ê¸°
const getMediItemList = function() {
	console.log("ì—¬ê¸°ëŠ” getMediItemList");
	let xhr = new XMLHttpRequest();
	xhr.open("get", "/order/mediList", true);
	xhr.onreadystatechange = function() {
		if(xhr.readyState == 4 && xhr.status == 200) {
			let result = JSON.parse(xhr.responseText);
			console.log("ë°›ì•„ì˜¨ ì•½í’ˆ ì‹ ì²­ ì¡°íšŒ ë¦¬ìŠ¤íŠ¸", result);
			
			$('#orderHeader p').text("ğŸ”” ì´ " + result.length + "ê°œì˜ ì•½í’ˆì‹ ì²­ë‚´ì—­ì´ ìˆìŠµë‹ˆë‹¤.");
			
			let tblStr = `<table class="table table-hover">
						<thead>
							<tr>
								<th>ë°˜ë ¤ì²´í¬</th>
								<th>ì•½í’ˆì½”ë“œ</th>
								<th>ì•½í’ˆëª…</th>
								<th>ê±°ë˜ì²˜</th>
								<th>ê¸ˆì•¡</th>
								<th>ì‹ ì²­ìˆ˜ëŸ‰</th>
								<th>ì‹ ì²­ì¼ì</th>
								<th>ì‹ ì²­ì¸</th> 
							</tr>
						</thead>
						<tbody>`;
			for(let i=0; i<result.length; i++) {
				tblStr += `<tr>`;
				tblStr += `<td><input class="form-check-input" type="checkbox" id="defaultCheck3"></td>`;
				tblStr += `<td>\${result[i].mediItemCode}</td>`;
				tblStr += `<td>\${result[i].mediItemName}</td>`;
				tblStr += `<td>\${result[i].mediItemMakr}</td>`;
				tblStr += `<td>\${result[i].mediItemPrice}</td>`;
				tblStr += `<td>\${result[i].mediItemReqQy}</td>`;
				tblStr += `<td>\${result[i].mediItemReqDe}</td>`;
				tblStr += `<td>\${result[i].empNm}</td>`;
				tblStr += `</tr>`;
			}
			tblStr += `</tbody></table>`;
			
// 			console.log("tblStr" + tblStr);
			$('#myTable').html(tblStr);
		} 
	}
	xhr.send();
}

</script>
</html>